

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyscses.grid &mdash; pyscses 0.9.3.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> pyscses
          

          
          </a>

          
            
            
              <div class="version">
                0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">API documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">pyscses</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyscses</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>pyscses.grid</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyscses.grid</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">pyscses.constants</span> <span class="k">import</span> <span class="n">boltzmann_eV</span>
<span class="kn">from</span> <span class="nn">bisect</span> <span class="k">import</span> <span class="n">bisect_left</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="k">import</span> <span class="n">griddata</span>

<div class="viewcode-block" id="phi_at_x"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.phi_at_x">[docs]</a><span class="k">def</span> <span class="nf">phi_at_x</span><span class="p">(</span> <span class="n">phi</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">x</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assigns each site x coordinate a grid point and returns the electrostatic potential at the grid point clostest to the x coordinate.</span>

<span class="sd">    Args:</span>
<span class="sd">        phi (np.array): electrostatic potential on 1D grid. </span>
<span class="sd">        coordinates (np.array): 1D grid of ordered numbers over a region.</span>
<span class="sd">        x (float): Site x coordinate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        phi[index] (float): The electrostatic potential at the x coordinate with position [index].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">index</span> <span class="o">=</span> <span class="n">index_of_grid_at_x</span><span class="p">(</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">x</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">phi</span><span class="p">[</span> <span class="n">index</span> <span class="p">]</span></div>

<div class="viewcode-block" id="energy_at_x"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.energy_at_x">[docs]</a><span class="k">def</span> <span class="nf">energy_at_x</span><span class="p">(</span> <span class="n">energy</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">x</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assigns each site x coordinate a grid point and returns the segregation energy at the grid point clostest to the x coordinate.</span>

<span class="sd">    Args:</span>
<span class="sd">        energy (np.array): Segregation energies on 1D grid. </span>
<span class="sd">        coordinates (np.array): 1D grid of ordered numbers over a region.</span>
<span class="sd">        x (float): Site x coordinate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        energy[index] (float): The segregation energy at the x coordinate with position [index].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">index</span> <span class="o">=</span> <span class="n">index_of_grid_at_x</span><span class="p">(</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">x</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">energy</span><span class="p">[</span> <span class="n">index</span> <span class="p">]</span></div>

<div class="viewcode-block" id="index_of_grid_at_x"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.index_of_grid_at_x">[docs]</a><span class="k">def</span> <span class="nf">index_of_grid_at_x</span><span class="p">(</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">x</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Assigns each site x coordinate to a position on a regularly or irregularly spaced grid. </span>
<span class="sd">    Returns the index of the grid point clostest to the value x </span>

<span class="sd">    Args:</span>
<span class="sd">        coordinates (np.array): 1D grid of ordered numbers over a region.</span>
<span class="sd">        x (float): Site x coordinate</span>

<span class="sd">    Returns:</span>
<span class="sd">        closest_index (int): Index of grid position closest to the site x coordinate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">closest_index</span><span class="p">(</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">x</span> <span class="p">)</span></div>

<div class="viewcode-block" id="closest_index"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.closest_index">[docs]</a><span class="k">def</span> <span class="nf">closest_index</span><span class="p">(</span><span class="n">myList</span><span class="p">,</span> <span class="n">myNumber</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assumes myList is sorted. Returns index of closest value to myNumber.</span>
<span class="sd">    If two numbers are equally close, return the index of the smallest number.</span>

<span class="sd">    Args:</span>
<span class="sd">        myList  (list): List of numbers to compare against. This should be sorted.</span>
<span class="sd">        myNumber (float): The number to compare against myList.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pos (int): Index of position of number in myList which is closest to myNumber.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="n">myList</span><span class="p">,</span> <span class="n">myNumber</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">myList</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">myList</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">before</span> <span class="o">=</span> <span class="n">myList</span><span class="p">[</span><span class="n">pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">after</span> <span class="o">=</span> <span class="n">myList</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">after</span> <span class="o">-</span> <span class="n">myNumber</span> <span class="o">&lt;</span> <span class="n">myNumber</span> <span class="o">-</span> <span class="n">before</span><span class="p">:</span>
       <span class="k">return</span> <span class="n">pos</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="k">return</span> <span class="n">pos</span> <span class="o">-</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="delta_x_from_grid"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.delta_x_from_grid">[docs]</a><span class="k">def</span> <span class="nf">delta_x_from_grid</span><span class="p">(</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">limits</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the distance between the midpoints of each consecutive site. Inserts the calculated distance to the next grid point outside of the calculation region to the first and last position as the delta_x value for the endmost sites. </span>
<span class="sd">    Args:</span>
<span class="sd">        coordinates (np.array): 1D grid of ordered numbers over a region.</span>
<span class="sd">        limits (list): Distance between the midpoint of the endmost sites and the midpoint of the repective site outside of the calculation region.</span>
<span class="sd">    Returns:</span>
<span class="sd">        delta_x (np.array): Distance between the midpoints of each consecutive site.  </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">delta_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span> <span class="n">coordinates</span> <span class="p">)</span>
    <span class="n">delta_x</span> <span class="o">=</span> <span class="p">(</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="n">coordinates</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
    <span class="n">delta_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="n">delta_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">delta_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="n">delta_x</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">delta_x</span><span class="p">),</span> <span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">delta_x</span></div>

<div class="viewcode-block" id="Grid_Point"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.Grid_Point">[docs]</a><span class="k">class</span> <span class="nc">Grid_Point</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; The Grid_Point class contains the information and calculations for each grid point individually &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">volume</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        x (float): x coordinate of grid point.</span>
<span class="sd">        volume (float): volume of site at grid point.</span>
<span class="sd">        sites (list): defect sites at grid point.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">volume</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sites</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="Grid_Point.average_site_energy"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.Grid_Point.average_site_energy">[docs]</a>    <span class="k">def</span> <span class="nf">average_site_energy</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">   </span>
<span class="sd">        Returns the average segregation energy for all sites based on a specified method </span>

<span class="sd">        Args: </span>
<span class="sd">            method (str): The method in which the average segregation energies will be calculated.</span>
<span class="sd">                          &#39;mean&#39; - Returns the sum of all values at that site divided by the number of values at that site.</span>
<span class="sd">                          &#39;min&#39; - Returns the minimum segregation energy value for that site (appropriate for low temperature calculations).</span>

<span class="sd">        Returns:</span>
<span class="sd">            average site energies (np.array): Average segregation energies on a 1D grid.</span>
<span class="sd">  </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">avg</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span> <span class="n">s</span><span class="o">.</span><span class="n">energies</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sites</span> <span class="p">]</span> <span class="p">),</span> <span class="n">method</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span></div></div>

<div class="viewcode-block" id="avg"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.avg">[docs]</a><span class="k">def</span> <span class="nf">avg</span><span class="p">(</span> <span class="n">energies</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">   </span>
<span class="sd">    Returns the average segregation energy for a site based on a specified method </span>

<span class="sd">    Args: </span>
<span class="sd">        energies (np.array): Segregation energies on 1D grid.  </span>
<span class="sd">        method (str): The method in which the average segregation energies will be calculated.</span>
<span class="sd">                      &#39;mean&#39; - Returns the sum of all values at that site divided by the number of values at that site.</span>
<span class="sd">                      &#39;min&#39; - Returns the minimum segregation energy value for that site (appropriate for low temperature calculations).</span>

<span class="sd">    Returns:</span>
<span class="sd">        average site energies (np.array): Average segregation energies on a 1D grid.</span>
<span class="sd">  </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;mean&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">row</span> <span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">energies</span><span class="o">.</span><span class="n">T</span> <span class="p">]</span> 
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span> <span class="n">row</span> <span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">energies</span><span class="o">.</span><span class="n">T</span> <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s2">&quot;method: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">method</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Grid"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.Grid">[docs]</a><span class="k">class</span> <span class="nc">Grid</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x_coordinates</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">limits</span><span class="p">,</span> <span class="n">limits_for_laplacian</span><span class="p">,</span> <span class="n">set_of_sites</span> <span class="p">):</span>
       <span class="c1"># x_coordinates need to be sorted for the delta_x calculation in volumes_from_grid</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Grid objects contain information and methods for the calculation grid.</span>
<span class="sd">  </span>
<span class="sd">        Args:</span>
<span class="sd">            delta_x (np.array): Distance between the midpoint of each consecutive grid point. </span>
<span class="sd">            volumes (np.array): Volume of each consecutive grid point. </span>
<span class="sd">            points (list): Grid_Point object at each grid point in Grid.</span>
<span class="sd">            x (np.array): The x-coordinates for each grid point.</span>
<span class="sd">            limits(list): distance between the midpoint of the endmost sites and the midpoint of the next site outside of the calculation region for the first and last sites respectively. </span>
<span class="sd">            limits_for_laplacian(list): distance between the endmost sites and the next site outside of the calculation region for the first and last sites respectively.</span>
<span class="sd">            b (float):                b dimension for every grid-point.</span>
<span class="sd">            c (float):                c dimension for every grid-point.</span>
<span class="sd">            limits ([float,float])    x-coordinates for the minimum and maximum grid edges.</span>
<span class="sd">            set_of_sites (object): Set of Site objects that populate the Grid.</span>
<span class="sd">            defect_Species (list): Defect species that populate the Grid.  </span>
<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta_x</span> <span class="o">=</span> <span class="n">delta_x_from_grid</span><span class="p">(</span> <span class="n">x_coordinates</span><span class="p">,</span> <span class="n">limits</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volumes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_x</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">c</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Grid_Point</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span> <span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">x_coordinates</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volumes</span> <span class="p">)</span> <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x_coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="n">limits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limits_for_laplacian</span> <span class="o">=</span> <span class="n">limits_for_laplacian</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_of_sites</span> <span class="o">=</span> <span class="n">set_of_sites</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defect_species</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">set_of_sites</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">index_of_grid_at_x</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">site</span><span class="o">.</span><span class="n">x</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span> <span class="n">i</span> <span class="p">]</span><span class="o">.</span><span class="n">sites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">site</span> <span class="p">)</span> 
            <span class="n">site</span><span class="o">.</span><span class="n">grid_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">defect_species</span> <span class="ow">in</span> <span class="n">site</span><span class="o">.</span><span class="n">defect_species</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">defect_species</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defect_species</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">defect_species</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">defect_species</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">key</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span> <span class="n">key</span> <span class="p">]</span>

<div class="viewcode-block" id="Grid.charge"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.Grid.charge">[docs]</a>    <span class="k">def</span> <span class="nf">charge</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">temp</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the overall charge at each point on a grid.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            phi (np.array): Electrostatic potential on a 1D grid. </span>
<span class="sd">            temp (float): Temperature of calculation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            charge (np.array): Overall charge at each point on a 1D grid. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">charge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
            <span class="n">charge</span><span class="p">[</span> <span class="n">i</span> <span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span> <span class="p">[</span> <span class="n">site</span><span class="o">.</span><span class="n">charge</span><span class="p">(</span> <span class="n">phi_at_x</span><span class="p">(</span> <span class="n">phi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">site</span><span class="o">.</span><span class="n">x</span> <span class="p">),</span> <span class="n">temp</span> <span class="p">)</span> <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">point</span><span class="o">.</span><span class="n">sites</span> <span class="p">]</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">charge</span></div>

<div class="viewcode-block" id="Grid.rho"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.Grid.rho">[docs]</a>    <span class="k">def</span> <span class="nf">rho</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">temp</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates charge density at each point on a grid, by dividing the overall charge at that grid point by the grid point volume.</span>

<span class="sd">        Args:</span>
<span class="sd">            phi (np.array): Electrostatic potential on a 1D grid.</span>
<span class="sd">            temp (float): Temperature of calculation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            rho (np.array): The charge density at each point on a grid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="p">)</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">(</span> <span class="n">phi</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">volumes</span>
        <span class="k">return</span> <span class="n">rho</span></div>

<div class="viewcode-block" id="Grid.defect_valences"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.Grid.defect_valences">[docs]</a>    <span class="k">def</span> <span class="nf">defect_valences</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            (np.array): Valences for each defect from self.defects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">sites</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span> <span class="n">d</span><span class="o">.</span><span class="n">valence</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">site</span><span class="o">.</span><span class="n">defects</span> <span class="p">]</span> <span class="p">)</span></div>


<div class="viewcode-block" id="Grid.average_site_energies"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.Grid.average_site_energies">[docs]</a>    <span class="k">def</span> <span class="nf">average_site_energies</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Returns the average segregation energy for all grid points based on a specified method </span>

<span class="sd">        Args: </span>
<span class="sd">            method (str): The method in which the average segregation energies will be calculated.</span>
<span class="sd">                          &#39;mean&#39; - Returns the sum of all values at that site divided by the number of values at that site.</span>
<span class="sd">                          &#39;min&#39; - Returns the minimum segregation energy value for that site (appropriate for low temperature calculations).</span>

<span class="sd">        Returns:</span>
<span class="sd">            average site energies (np.array): Average segregation energies on a 1D grid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span> <span class="n">p</span><span class="o">.</span><span class="n">average_site_energy</span><span class="p">(</span> <span class="n">method</span> <span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">T</span></div>

<div class="viewcode-block" id="Grid.interpolated_energies"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.Grid.interpolated_energies">[docs]</a>    <span class="k">def</span> <span class="nf">interpolated_energies</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">           energies (list): The average site energies linearly interpolated onto a regularly spaced grid</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">energies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">average_site_energies</span><span class="p">():</span>
            <span class="n">x_new</span><span class="p">,</span> <span class="n">e_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">e</span> <span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">row</span> <span class="p">)</span> <span class="k">if</span> <span class="n">e</span> <span class="p">]</span> <span class="p">)</span><span class="o">.</span><span class="n">T</span>
            <span class="n">interpolated_energies</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span> <span class="n">x_new</span><span class="p">,</span> <span class="n">e_new</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">fill_value</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="p">)</span>
            <span class="n">energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">interpolated_energies</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">energies</span></div>

<div class="viewcode-block" id="Grid.subgrid"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.Grid.subgrid">[docs]</a>    <span class="k">def</span> <span class="nf">subgrid</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">subset_species</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a subgrid for each species.</span>
<span class="sd">        Args:</span>
<span class="sd">            subset_species (str): Site species to separate into subgrid. </span>
<span class="sd">        Returns:</span>
<span class="sd">            Grid (object): Grid object for subset of data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Grid</span><span class="o">.</span><span class="n">grid_from_set_of_sites</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_of_sites</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="n">subset_species</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits_for_laplacian</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="p">)</span> </div>

<div class="viewcode-block" id="Grid.grid_from_set_of_sites"><a class="viewcode-back" href="../../pyscses.html#pyscses.grid.Grid.grid_from_set_of_sites">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">grid_from_set_of_sites</span><span class="p">(</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">set_of_sites</span><span class="p">,</span> <span class="n">limits</span><span class="p">,</span> <span class="n">limits_for_laplacian</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a grid from a given Set_of_Sites object.</span>
<span class="sd">        Args:</span>
<span class="sd">            set_of_sites (object): Set_of_Sites object containing a set of all Site objects. </span>
<span class="sd">            limits (list): distance between the midpoint of the endmost sites and the midpoint of the next site outside of the calculation region for the first and last sites respectively. </span>
<span class="sd">            limits_for_laplacian (list): distance between the endmost sites and the next site outside of the calculation region for the first and last sites respectively.</span>
<span class="sd">            b (float):                b dimension for every grid-point.</span>
<span class="sd">            c (float):                c dimension for every grid-point.</span>
<span class="sd">        Returns:</span>
<span class="sd">            Grid (object): Grid object for the given set of sites. </span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span> <span class="p">[</span> <span class="n">site</span><span class="o">.</span><span class="n">x</span> <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">set_of_sites</span> <span class="p">]</span> <span class="p">),</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">limits</span><span class="p">,</span> <span class="n">limits_for_laplacian</span><span class="p">,</span> <span class="n">set_of_sites</span> <span class="p">)</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Georgina Wellock

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>