

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyscses package &mdash; pyscses 0.9.3.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="pyscses" href="modules.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pyscses
          

          
          </a>

          
            
            
              <div class="version">
                0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">API documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pyscses</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">pyscses package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscses.calculation">pyscses.calculation module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscses.constants">pyscses.constants module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscses.defect_at_site">pyscses.defect_at_site module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscses.defect_species">pyscses.defect_species module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscses.grid">pyscses.grid module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscses.matrix_solver">pyscses.matrix_solver module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscses.set_of_sites">pyscses.set_of_sites module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscses.set_up_calculation">pyscses.set_up_calculation module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscses.site">pyscses.site module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscses">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyscses</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">pyscses</a> &raquo;</li>
        
      <li>pyscses package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pyscses.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="pyscses-package">
<h1>pyscses package<a class="headerlink" href="#pyscses-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyscses.calculation">
<span id="pyscses-calculation-module"></span><h2>pyscses.calculation module<a class="headerlink" href="#module-pyscses.calculation" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyscses.calculation.Calculation">
<em class="property">class </em><code class="descclassname">pyscses.calculation.</code><code class="descname">Calculation</code><span class="sig-paren">(</span><em>grid</em>, <em>bulk_x_min</em>, <em>bulk_x_max</em>, <em>alpha</em>, <em>convergence</em>, <em>dielectric</em>, <em>temp</em>, <em>boundary_conditions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The Calculation class contains all of the functions required to calculate all of the relevant space charge properties for any given system, such as electrostatic potential, charge density, defect mole fractions and parallel and perpendicular grain boundary resistivities.
:param grid: Grid object - contains properties of the grid including the x coordinates and the volumes.
:type grid: object
:param bulk_x_min: The minimum x coordinate defining a region of bulk.
:type bulk_x_min: float
:param bulk_x_max: The maximum x coordinate defining a region of bulk.
:type bulk_x_max: float
:param alpha: A damping parameter for updating the potential at each iteration.
:type alpha: float
:param convergence: The convergence limit. The difference between the updated phi and the phi from the previous iteration must be below this for the calculation to be sufficently converged.
:type convergence: float
:param dielectric: The dielectric constant for the studied material.
:type dielectric: float
:param temp: The temperature that the calculation is run.
:type temp: float
:param boundary_conditions: Specified boundary conditions for the matrix solver. Allowed values are <cite>dirichlet</cite> and <cite>periodic</cite>. Default = <cite>dirichlet</cite>.
:type boundary_conditions: str</p>
<dl class="method">
<dt id="pyscses.calculation.Calculation.calculate_average">
<code class="descname">calculate_average</code><span class="sig-paren">(</span><em>grid</em>, <em>min_cut_off</em>, <em>max_cut_off</em>, <em>sc_property</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.calculate_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.calculate_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the average of a given space chage property over a given region.
:param grid: Grid object - contains properties of the grid including the x coordinates and the volumes. Used to access the x coordinates.
:type grid: object
:param min_cut_off: Minimum x coordinate value defining the calculation region.
:type min_cut_off: float
:param max_cut_off: Maximum x coordinate value defining the calculation region.
:type max_cut_off: float
:param sc_property: Value of space charge property at all sites.
:type sc_property: list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The average value for the property over the given sites.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">average_sc_propery (float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.calculate_debye_length">
<code class="descname">calculate_debye_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.calculate_debye_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.calculate_debye_length" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Debye length as derived from Poisson-Boltzmann equation</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">debye_length( float )</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.calculate_delta_x">
<code class="descname">calculate_delta_x</code><span class="sig-paren">(</span><em>grid</em>, <em>min_cut_off</em>, <em>max_cut_off</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.calculate_delta_x"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.calculate_delta_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the distance between the midpoints of each consecutive site. Inserts the calculated distance to the next grid point outside of the calculation region to the first and last position as the delta_x value for the endmost sites.
:param grid: Grid object - contains properties of the grid including the x coordinates and the volumes. Used to access the x coordinates.
:type grid: object
:param min_cut_off: Minimum x coordinate value defining the calculation region.
:type min_cut_off: float
:param max_cut_off: Maximum x coordinate value defining the calculation region.
:type max_cut_off: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Distance between consecutive sites.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">delta_x_from_grid (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.calculate_mobile_defect_conductivities">
<code class="descname">calculate_mobile_defect_conductivities</code><span class="sig-paren">(</span><em>pos_or_neg_scr</em>, <em>scr_limit</em>, <em>species</em>, <em>mobility_scaling=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.calculate_mobile_defect_conductivities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.calculate_mobile_defect_conductivities" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the conductivity ratio between the space charge region and the bulk both perpendicular and parallel to the grain boundary.
A Set_of_Sites object is created for the sites in the space charge region, and the defect distributions calculated. The width of the space charge region is calculated and a bulk region of the same width is defined. A Set_of_Sites object for the bulk region is created and the defect distributions calculated. Taking each site as a resistor in series or parallel respectively, the conductivity is calculated and the ratio between the space charge region and the bulk is taken.
:param pos_or_neg_scr: ‘positive’ - for a positive space charge potential.</p>
<blockquote>
<div>‘negative’ - for a negative space charge potential.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>scr_limit</strong> (<em>float</em>) – The minimum electrostatic potential that the electrostatic potential must exceed to be included in the space charge region.</li>
<li><strong>species</strong> (<em>str</em>) – The species for which the conductivity is being calculated.</li>
<li><strong>mobility_scaling</strong> (<em>bool</em>) – For particles on a lattice which only interact through volume exclusion, the mobility exhibits a blocking term. True if the blocking term is to be included, False if the blocking term is not to be included. Default = False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The conductivity ratio between the bulk and the space charge region perpendicular to the grain boundary.
parallel_conductivity_ratio (float): The conductivity ratio between the bulk and the space charge region parallel to the grain boundary.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">perpendicular_conductivity_ratio (float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.calculate_offset">
<code class="descname">calculate_offset</code><span class="sig-paren">(</span><em>grid</em>, <em>min_cut_off</em>, <em>max_cut_off</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.calculate_offset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.calculate_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the offset between the midpoint of the last x coordinate in the calculation region and the x coordinate outside of the calulation region.
:param grid: Grid object - contains properties of the grid including the x coordinates and the volumes. Used to access the x coordinates.
:type grid: object
:param min_cut_off: Minimum x coordinate value defining the calculation region.
:type min_cut_off: float
:param max_cut_off: Maximum x coordinate value defining the calculation region.
:type max_cut_off: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Offset for the minimum x coordinate.
max_offset (float): Offset fot the maximum x coordinate.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">min_offset (float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.calculate_resistivity_ratio">
<code class="descname">calculate_resistivity_ratio</code><span class="sig-paren">(</span><em>pos_or_neg_scr</em>, <em>scr_limit</em>, <em>mobility_scaling=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.calculate_resistivity_ratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.calculate_resistivity_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Each species present in the system is looped over and the perpendicular and parallel conductivity ratios are calculated and appended to separate lists. Once all species have been added to the list, the conductivities are summed and the reciprocal taken to give the resistivity ratios perpendicular and parallel to the grain boundary.
:param pos_or_neg_scr: ‘positive’ - for a positive space charge potential.</p>
<blockquote>
<div>‘negative’ - for a negative space charge potential.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>scr_limit</strong> (<em>float</em>) – The minimum electrostatic potential that the electrostatic potential must exceed to be included in the space charge region.</li>
<li><strong>mobility_scaling</strong> (<em>bool</em>) – For particles on a lattice which only interact through volume exclusion, the mobility exhibits a blocking term. True if the blocking term is to be included, False if the blocking term is not to be included. Default = False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The resistivity ratio between the bulk and the space charge region perpendicular to the grain boundary.
parallel_resistivity_ratio (float): The resistivity ratio between the bulk and the space charge region parallel to the grain boundary.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">perpendicular_resistivity_ratio (float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.calculate_space_charge_width">
<code class="descname">calculate_space_charge_width</code><span class="sig-paren">(</span><em>valence</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.calculate_space_charge_width"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.calculate_space_charge_width" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the approximate space charge width from the debye length.
:param valence: The charge of the mobile defect species.
:type valence: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Approximate space charge width.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">space_charge_width( float )</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.create_space_charge_region">
<code class="descname">create_space_charge_region</code><span class="sig-paren">(</span><em>grid</em>, <em>pos_or_neg_scr</em>, <em>scr_limit</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.create_space_charge_region"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.create_space_charge_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the space charge region. The space charge region is defined as the region when the electrostatic potential is greater than a predefined limit.
:param grid: Grid object - contains properties of the grid including the x coordinates and the volumes. Used to access the x coordinates.
:type grid: object
:param pos_or_neg_scr: ‘positive’ - for a positive space charge potential.</p>
<blockquote>
<div>‘negative’ - for a negative space charge potential.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>scr_limit</strong> (<em>float</em>) – The minimum electrostatic potential that the electrostatic potential must exceed to be included in the space charge region.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of x coordinates for sites within the space charge region.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">space_charge_region (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.create_subregion_sites">
<code class="descname">create_subregion_sites</code><span class="sig-paren">(</span><em>grid</em>, <em>min_cut_off</em>, <em>max_cut_off</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.create_subregion_sites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.create_subregion_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Set_of_Sites object for a defined region of the grid.
:param grid: Grid object - contains properties of the grid including the x coordinates and the volumes. Used to access the x coordinates.
:type grid: object
:param min_cut_off: Minimum x coordinate value defining the calculation region.
:type min_cut_off: float
:param max_cut_off: Maximum x coordinate value defining the calculation region.
:type max_cut_off: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Set of Sites object for a given subregion of the grid.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">sites (object)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.find_index">
<code class="descname">find_index</code><span class="sig-paren">(</span><em>grid</em>, <em>min_cut_off</em>, <em>max_cut_off</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.find_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.find_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the indices of the grid positions closest to a minimum and maximum value.
:param grid: Grid object - contains properties of the grid including the x coordinates and the volumes. Used to access the x coordinates.
:type grid: object
:param min_cut_off: Minimum x coordinate value defining the calculation region.
:type min_cut_off: float
:param max_cut_off: Maximum x coordinate value defining the calculation region.
:type max_cut_off: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Index for minimum cut off.
max_index (int): Index for maximum cut off.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">min_index (int)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.form_subgrids">
<code class="descname">form_subgrids</code><span class="sig-paren">(</span><em>site_labels</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.form_subgrids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.form_subgrids" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Grid class for each species in the system.
:param site_labels: List of strings for the different site species.
:type site_labels: list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Dictionary of separate Grid classes for the different site species (name).</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">subgrids[name]( dict )</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.mole_fraction_correction">
<code class="descname">mole_fraction_correction</code><span class="sig-paren">(</span><em>target_mole_fractions</em>, <em>approximation</em>, <em>initial_guess</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.mole_fraction_correction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.mole_fraction_correction" title="Permalink to this definition">¶</a></dt>
<dd><p>Starting from an initial guess for the appropriate input mole fractions, minimises the error between the target bulk mole fraction and the output mole fraction from the iterative Poisson-Boltzmann solver.
:param target_mole_fractions: The value that the mole fractions should be in the bulk.
:type target_mole_fractions: list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The optimum values to be used as the input mole fractions for the iterative Poisson-Boltzmann solver so that the output bulk mole fractions are the target bulk mole fractions.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">opt_mole_fractions( list )</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.mole_fraction_error">
<code class="descname">mole_fraction_error</code><span class="sig-paren">(</span><em>input_mole_fractions</em>, <em>target_mole_fractions</em>, <em>approximation</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.mole_fraction_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.mole_fraction_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sum of sqaures error between the output mole fractions calculated from the input mole fractions, compared to the target mole fractions.
:param input_mole_fractions: Mole fractions for each of the species used in the iterative Poisson-Boltzmann solver.
:type input_mole_fractions: list
:param target_mole_fractions: The value that the mole fractions should be in the bulk.
:type target_mole_fractions: list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Sum of squares error between output and target mole fractions.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.mole_fraction_output">
<code class="descname">mole_fraction_output</code><span class="sig-paren">(</span><em>input_mole_fractions</em>, <em>approximation</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.mole_fraction_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.mole_fraction_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the output mole fraction for a given input mole fraction when solving the Poisson-Boltzmann equation.
:param input_mole_fractions: Mole fractions for each of the species used in the iterative Poisson-Boltzmann solver.
:type input_mole_fractions: list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Mole fractions that are calculated from the iterative Poisson-Boltzmann solver.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">output_mole_fractions( list )</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.mole_fractions">
<code class="descname">mole_fractions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.mole_fractions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.mole_fractions" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mole fractions (probability of defects occupation ) for each site on the subgrid for each species.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A dictionary of the defect species mole fractions for each site on the subgrid for each site species.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">mf( dict )</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><em>approximation</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Self-consistent solving of the Poisson-Boltzmann equation. Iterates until the convergence is less than the convergence limit.
:param approximation: Approximation used for the defect behaviour.</p>
<blockquote>
<div>‘mott-schottky’ - Some defects immobile / fixed to bulk mole fractions.
‘gouy-chapman’ - All defects mobile / able to redistribute.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Electrostatic potential on a one-dimensional grid.
rho (float): Charge density on a one-dimensional grid.
niter (int): Number of iterations performed to reach convergence.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">phi (array)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.calculation.Calculation.solve_MS_approx_for_phi">
<code class="descname">solve_MS_approx_for_phi</code><span class="sig-paren">(</span><em>valence</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#Calculation.solve_MS_approx_for_phi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.Calculation.solve_MS_approx_for_phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the calculated resistivity ratio, solves the Mott-Schottky model to calculate the space charge potential (analogous to experimental analysis).
If the resistivity ratio calculated is less that 1.36, ValueError raised as solution to the Mott-Schottky model is not on a real branch.
:param valence: Charge of species at site.
:type valence: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Space charge potential calculated from Mott-Schottky model</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ms_phi( float )</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyscses.calculation.calculate_activation_energies">
<code class="descclassname">pyscses.calculation.</code><code class="descname">calculate_activation_energies</code><span class="sig-paren">(</span><em>ratios</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#calculate_activation_energies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.calculate_activation_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves the Arrhenius equation using the calculated resistivity ratio for a series of temperatures to calculate the activation energy for single defect segregation.
Uses a central difference approach so endpoints filled in with NaN to create an array with the same length as the args.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ratios</strong> (<em>list</em>) – Resistivity ratios calculated for a range of temperatures.</li>
<li><strong>temp</strong> (<em>list</em>) – Temperature (values used to calculate resistivity ratio values).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The activation energy calculated for different temperatures.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Ea2( np.array )</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyscses.calculation.diff_central">
<code class="descclassname">pyscses.calculation.</code><code class="descname">diff_central</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/calculation.html#diff_central"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.calculation.diff_central" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the numerical derivative of x,y data using a central difference approximation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>y</strong> (<em>x</em><em>,</em>) – x,y data to be differentiated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">numerical derivative of x,y</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(array)</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pyscses.constants">
<span id="pyscses-constants-module"></span><h2>pyscses.constants module<a class="headerlink" href="#module-pyscses.constants" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyscses.defect_at_site">
<span id="pyscses-defect-at-site-module"></span><h2>pyscses.defect_at_site module<a class="headerlink" href="#module-pyscses.defect_at_site" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyscses.defect_at_site.Defect_at_Site">
<em class="property">class </em><code class="descclassname">pyscses.defect_at_site.</code><code class="descname">Defect_at_Site</code><span class="sig-paren">(</span><em>label</em>, <em>valence</em>, <em>mole_fraction</em>, <em>mobility</em>, <em>energy</em>, <em>site</em>, <em>fixed=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/defect_at_site.html#Defect_at_Site"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.defect_at_site.Defect_at_Site" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The Defect_at_Site class contains the information about each defect at each site, its valence, mole fraction and the segregation energy for that defect at that site.
This functions in this class combine to give the correct statistics for site occupation in solid electrolytes, derived from the electrochemical potentials of a Fermi-Dirac like distribution. This term has been split into three functions for simplicity. The resulting equations take into account that the probability that a site is occupied by a defect can not exceed 1, and also accounts for competition of like charged defects.
A Mott-Schottky approximation can be enforced. The defects can be fixed to their bulk mole fractions throughout the system, equivalent to assuming that the defects are immobile and not allowed to redistribute through the system.</p>
<dl class="attribute">
<dt id="pyscses.defect_at_site.Defect_at_Site.label">
<code class="descname">label</code><a class="headerlink" href="#pyscses.defect_at_site.Defect_at_Site.label" title="Permalink to this definition">¶</a></dt>
<dd><p>refers to what the defect is called i.e. ‘Vo’ for an oxygen vacancy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyscses.defect_at_site.Defect_at_Site.valence">
<code class="descname">valence</code><a class="headerlink" href="#pyscses.defect_at_site.Defect_at_Site.valence" title="Permalink to this definition">¶</a></dt>
<dd><p>The charge of the defect, in atomic units.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyscses.defect_at_site.Defect_at_Site.mole_fraction">
<code class="descname">mole_fraction</code><a class="headerlink" href="#pyscses.defect_at_site.Defect_at_Site.mole_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>The bulk mole fraction of the defect present in the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyscses.defect_at_site.Defect_at_Site.mobility">
<code class="descname">mobility</code><a class="headerlink" href="#pyscses.defect_at_site.Defect_at_Site.mobility" title="Permalink to this definition">¶</a></dt>
<dd><p>The bulk mobility of the defect species. Default = 0.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyscses.defect_at_site.Defect_at_Site.energy">
<code class="descname">energy</code><a class="headerlink" href="#pyscses.defect_at_site.Defect_at_Site.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>The segregation energy for the defect when occupying the respective site.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyscses.defect_at_site.Defect_at_Site.site">
<code class="descname">site</code><a class="headerlink" href="#pyscses.defect_at_site.Defect_at_Site.site" title="Permalink to this definition">¶</a></dt>
<dd><p>The site object that corresponding to each defect at each x coordinate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">cls</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyscses.defect_at_site.Defect_at_Site.fixed">
<code class="descname">fixed</code><a class="headerlink" href="#pyscses.defect_at_site.Defect_at_Site.fixed" title="Permalink to this definition">¶</a></dt>
<dd><p>set whether this defect species can redistribute to an equilibrium distriution. Default=False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.defect_at_site.Defect_at_Site.boltzmann_one">
<code class="descname">boltzmann_one</code><span class="sig-paren">(</span><em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/defect_at_site.html#Defect_at_Site.boltzmann_one"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.defect_at_site.Defect_at_Site.boltzmann_one" title="Permalink to this definition">¶</a></dt>
<dd><p>Boltzmann statistics calculation - part one</p>
<div class="math notranslate nohighlight">
\[\exp^{\dfrac{\Phi z+\Delta E}{k_BT}}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>float</em>) – Electrostatic potential.</li>
<li><strong>temp</strong> (<em>float</em>) – Temperature of calculation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Boltzmann statistics</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.defect_at_site.Defect_at_Site.boltzmann_three">
<code class="descname">boltzmann_three</code><span class="sig-paren">(</span><em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/defect_at_site.html#Defect_at_Site.boltzmann_three"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.defect_at_site.Defect_at_Site.boltzmann_three" title="Permalink to this definition">¶</a></dt>
<dd><p>Boltzmann statistics calculation - part three</p>
<div class="math notranslate nohighlight">
\[x(\exp^{\dfrac{\Phi z+\Delta E}{K_BT}}-1)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>float</em>) – Electrostatic potential.</li>
<li><strong>temp</strong> (<em>float</em>) – Temperature of calculation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">( Boltzmann statistics - 1 ) * mole fraction.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.defect_at_site.Defect_at_Site.boltzmann_two">
<code class="descname">boltzmann_two</code><span class="sig-paren">(</span><em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/defect_at_site.html#Defect_at_Site.boltzmann_two"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.defect_at_site.Defect_at_Site.boltzmann_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Boltzmann statistics calculation - part two</p>
<div class="math notranslate nohighlight">
\[x(\exp^{\dfrac{\Phi z+\Delta E}{K_BT}})\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>float</em>) – Electrostatic potential.</li>
<li><strong>temp</strong> (<em>float</em>) – Temperature of calculation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Boltzmann statistics * mole fraction</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.defect_at_site.Defect_at_Site.potential_energy">
<code class="descname">potential_energy</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/defect_at_site.html#Defect_at_Site.potential_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.defect_at_site.Defect_at_Site.potential_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Potential energy for the defect at this site.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi</strong> (<em>float</em>) – electrostatic potential at this site</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The electrochemical potential</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(float)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyscses.defect_species">
<span id="pyscses-defect-species-module"></span><h2>pyscses.defect_species module<a class="headerlink" href="#module-pyscses.defect_species" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyscses.defect_species.DefectSpecies">
<em class="property">class </em><code class="descclassname">pyscses.defect_species.</code><code class="descname">DefectSpecies</code><span class="sig-paren">(</span><em>label</em>, <em>valence</em>, <em>mole_fraction</em>, <em>mobility=0.0</em>, <em>fixed=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/defect_species.html#DefectSpecies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.defect_species.DefectSpecies" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The DefectSpecies class includes the properties of each defect species present in the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> (<em>string</em>) – refers to what the defect is called i.e. ‘Vo’ for an oxygen vacancy.</li>
<li><strong>valence</strong> (<em>float</em>) – The charge of the defect, in atomic units.</li>
<li><strong>mole_fraction</strong> (<em>float</em>) – The bulk mole fraction of the defect present in the system.</li>
<li><strong>fixed</strong> (<em>bool</em>) – Whether the defect species can redistribute to an equilibrium distribution or whether the defect species is considered immobile and fixed to it’s bulk mole fraction. Default=False.</li>
<li><strong>mobility</strong> (<em>float</em>) – Mobility of the defect species. Default = 0.0.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pyscses.grid">
<span id="pyscses-grid-module"></span><h2>pyscses.grid module<a class="headerlink" href="#module-pyscses.grid" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyscses.grid.Grid">
<em class="property">class </em><code class="descclassname">pyscses.grid.</code><code class="descname">Grid</code><span class="sig-paren">(</span><em>x_coordinates</em>, <em>b</em>, <em>c</em>, <em>limits</em>, <em>limits_for_laplacian</em>, <em>set_of_sites</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#Grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.Grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="pyscses.grid.Grid.average_site_energies">
<code class="descname">average_site_energies</code><span class="sig-paren">(</span><em>method='mean'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#Grid.average_site_energies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.Grid.average_site_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average segregation energy for all grid points based on a specified method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>method</strong> (<em>str</em>) – The method in which the average segregation energies will be calculated.
‘mean’ - Returns the sum of all values at that site divided by the number of values at that site.
‘min’ - Returns the minimum segregation energy value for that site (appropriate for low temperature calculations).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Average segregation energies on a 1D grid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">average site energies (np.array)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.grid.Grid.charge">
<code class="descname">charge</code><span class="sig-paren">(</span><em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#Grid.charge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.Grid.charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the overall charge at each point on a grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>np.array</em>) – Electrostatic potential on a 1D grid.</li>
<li><strong>temp</strong> (<em>float</em>) – Temperature of calculation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Overall charge at each point on a 1D grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">charge (np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.grid.Grid.defect_valences">
<code class="descname">defect_valences</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#Grid.defect_valences"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.Grid.defect_valences" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Valences for each defect from self.defects</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(np.array)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pyscses.grid.Grid.grid_from_set_of_sites">
<em class="property">classmethod </em><code class="descname">grid_from_set_of_sites</code><span class="sig-paren">(</span><em>set_of_sites</em>, <em>limits</em>, <em>limits_for_laplacian</em>, <em>b</em>, <em>c</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#Grid.grid_from_set_of_sites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.Grid.grid_from_set_of_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a grid from a given Set_of_Sites object.
:param set_of_sites: Set_of_Sites object containing a set of all Site objects.
:type set_of_sites: object
:param limits: distance between the midpoint of the endmost sites and the midpoint of the next site outside of the calculation region for the first and last sites respectively.
:type limits: list
:param limits_for_laplacian: distance between the endmost sites and the next site outside of the calculation region for the first and last sites respectively.
:type limits_for_laplacian: list
:param b: b dimension for every grid-point.
:type b: float
:param c: c dimension for every grid-point.
:type c: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Grid object for the given set of sites.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyscses.grid.Grid" title="pyscses.grid.Grid">Grid</a> (object)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.grid.Grid.interpolated_energies">
<code class="descname">interpolated_energies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#Grid.interpolated_energies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.Grid.interpolated_energies" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The average site energies linearly interpolated onto a regularly spaced grid</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">energies (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.grid.Grid.rho">
<code class="descname">rho</code><span class="sig-paren">(</span><em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#Grid.rho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.Grid.rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates charge density at each point on a grid, by dividing the overall charge at that grid point by the grid point volume.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>np.array</em>) – Electrostatic potential on a 1D grid.</li>
<li><strong>temp</strong> (<em>float</em>) – Temperature of calculation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The charge density at each point on a grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">rho (np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.grid.Grid.subgrid">
<code class="descname">subgrid</code><span class="sig-paren">(</span><em>subset_species</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#Grid.subgrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.Grid.subgrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a subgrid for each species.
:param subset_species: Site species to separate into subgrid.
:type subset_species: str</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Grid object for subset of data.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyscses.grid.Grid" title="pyscses.grid.Grid">Grid</a> (object)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyscses.grid.Grid_Point">
<em class="property">class </em><code class="descclassname">pyscses.grid.</code><code class="descname">Grid_Point</code><span class="sig-paren">(</span><em>x</em>, <em>volume</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#Grid_Point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.Grid_Point" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The Grid_Point class contains the information and calculations for each grid point individually</p>
<dl class="method">
<dt id="pyscses.grid.Grid_Point.average_site_energy">
<code class="descname">average_site_energy</code><span class="sig-paren">(</span><em>method='mean'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#Grid_Point.average_site_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.Grid_Point.average_site_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average segregation energy for all sites based on a specified method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>method</strong> (<em>str</em>) – The method in which the average segregation energies will be calculated.
‘mean’ - Returns the sum of all values at that site divided by the number of values at that site.
‘min’ - Returns the minimum segregation energy value for that site (appropriate for low temperature calculations).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Average segregation energies on a 1D grid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">average site energies (np.array)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyscses.grid.avg">
<code class="descclassname">pyscses.grid.</code><code class="descname">avg</code><span class="sig-paren">(</span><em>energies</em>, <em>method='mean'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#avg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.avg" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average segregation energy for a site based on a specified method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>energies</strong> (<em>np.array</em>) – Segregation energies on 1D grid.</li>
<li><strong>method</strong> (<em>str</em>) – The method in which the average segregation energies will be calculated.
‘mean’ - Returns the sum of all values at that site divided by the number of values at that site.
‘min’ - Returns the minimum segregation energy value for that site (appropriate for low temperature calculations).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Average segregation energies on a 1D grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">average site energies (np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyscses.grid.closest_index">
<code class="descclassname">pyscses.grid.</code><code class="descname">closest_index</code><span class="sig-paren">(</span><em>myList</em>, <em>myNumber</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#closest_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.closest_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Assumes myList is sorted. Returns index of closest value to myNumber.
If two numbers are equally close, return the index of the smallest number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>myList</strong> (<em>list</em>) – List of numbers to compare against. This should be sorted.</li>
<li><strong>myNumber</strong> (<em>float</em>) – The number to compare against myList.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Index of position of number in myList which is closest to myNumber.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pos (int)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyscses.grid.delta_x_from_grid">
<code class="descclassname">pyscses.grid.</code><code class="descname">delta_x_from_grid</code><span class="sig-paren">(</span><em>coordinates</em>, <em>limits</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#delta_x_from_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.delta_x_from_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the distance between the midpoints of each consecutive site. Inserts the calculated distance to the next grid point outside of the calculation region to the first and last position as the delta_x value for the endmost sites.
:param coordinates: 1D grid of ordered numbers over a region.
:type coordinates: np.array
:param limits: Distance between the midpoint of the endmost sites and the midpoint of the repective site outside of the calculation region.
:type limits: list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Distance between the midpoints of each consecutive site.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">delta_x (np.array)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyscses.grid.energy_at_x">
<code class="descclassname">pyscses.grid.</code><code class="descname">energy_at_x</code><span class="sig-paren">(</span><em>energy</em>, <em>coordinates</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#energy_at_x"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.energy_at_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns each site x coordinate a grid point and returns the segregation energy at the grid point clostest to the x coordinate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>energy</strong> (<em>np.array</em>) – Segregation energies on 1D grid.</li>
<li><strong>coordinates</strong> (<em>np.array</em>) – 1D grid of ordered numbers over a region.</li>
<li><strong>x</strong> (<em>float</em>) – Site x coordinate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The segregation energy at the x coordinate with position [index].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">energy[index] (float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyscses.grid.index_of_grid_at_x">
<code class="descclassname">pyscses.grid.</code><code class="descname">index_of_grid_at_x</code><span class="sig-paren">(</span><em>coordinates</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#index_of_grid_at_x"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.index_of_grid_at_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns each site x coordinate to a position on a regularly or irregularly spaced grid.
Returns the index of the grid point clostest to the value x</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>coordinates</strong> (<em>np.array</em>) – 1D grid of ordered numbers over a region.</li>
<li><strong>x</strong> (<em>float</em>) – Site x coordinate</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Index of grid position closest to the site x coordinate.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">closest_index (int)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyscses.grid.phi_at_x">
<code class="descclassname">pyscses.grid.</code><code class="descname">phi_at_x</code><span class="sig-paren">(</span><em>phi</em>, <em>coordinates</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/grid.html#phi_at_x"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.grid.phi_at_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns each site x coordinate a grid point and returns the electrostatic potential at the grid point clostest to the x coordinate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>np.array</em>) – electrostatic potential on 1D grid.</li>
<li><strong>coordinates</strong> (<em>np.array</em>) – 1D grid of ordered numbers over a region.</li>
<li><strong>x</strong> (<em>float</em>) – Site x coordinate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The electrostatic potential at the x coordinate with position [index].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">phi[index] (float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pyscses.matrix_solver">
<span id="pyscses-matrix-solver-module"></span><h2>pyscses.matrix_solver module<a class="headerlink" href="#module-pyscses.matrix_solver" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyscses.matrix_solver.MatrixSolver">
<em class="property">class </em><code class="descclassname">pyscses.matrix_solver.</code><code class="descname">MatrixSolver</code><span class="sig-paren">(</span><em>grid</em>, <em>dielectric</em>, <em>temp</em>, <em>boundary_conditions='dirichlet'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/matrix_solver.html#MatrixSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.matrix_solver.MatrixSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Contains the functions for the finite difference methods used to solve the Poisson-Boltzmann equation on a one-dimensional grid.</p>
<dl class="method">
<dt id="pyscses.matrix_solver.MatrixSolver.laplacian_new_fullmatrix">
<code class="descname">laplacian_new_fullmatrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/matrix_solver.html#MatrixSolver.laplacian_new_fullmatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.matrix_solver.MatrixSolver.laplacian_new_fullmatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the full tridiagonal matrix used to solve the Poisson-Boltzmann equation using a finite element method.
deltax is taken as the width of each grid point, from the center point between itself and the next grid point on either side.
Using a finite difference approximation the diagonal becomes -2.0 / (deltax_1 * deltax_2 ),
the upper diagonal becomes 2.0 / ( ( delta_x1 + delta_x2 ) * delta_x2 )
and the lower diagonal becomes 2.0 / ( ( delta_x1 + delta_x2 ) * delta_x1 ).
If boundary_conditions are ‘periodic’, the corner elements of the matrix are filled.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>None</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Full tridiagonal matrix.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">A (matrix)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.matrix_solver.MatrixSolver.laplacian_sparse">
<code class="descname">laplacian_sparse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/matrix_solver.html#MatrixSolver.laplacian_sparse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.matrix_solver.MatrixSolver.laplacian_sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a sparse matrix from a full matrix by taking only the tridiagonal values.
:param None:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Sparse tridiagonal matrix.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">A (matrix)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.matrix_solver.MatrixSolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><em>phi_old</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/matrix_solver.html#MatrixSolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.matrix_solver.MatrixSolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses matrix inversion to solve the Poisson-Boltzmann equation through finite difference methods. The defect mole fractions are calculated from the elctrostatic potential, the charge density is calculated from the defect mole fractions and the elctrostatic potential is then updated using the updated charge density. If boundary_conditions are ‘periodic’, the charge density is minimised before the matrix inversion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>phi_old</strong> (<em>array</em>) – Electrostatic potential on a one-dimensional grid.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Updated electrostatic potential on a one-dimensional grid.
rho (array): Updated charge density on a one-dimensional grid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">predicted_phi (array)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyscses.set_of_sites">
<span id="pyscses-set-of-sites-module"></span><h2>pyscses.set_of_sites module<a class="headerlink" href="#module-pyscses.set_of_sites" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyscses.set_of_sites.Set_of_Sites">
<em class="property">class </em><code class="descclassname">pyscses.set_of_sites.</code><code class="descname">Set_of_Sites</code><span class="sig-paren">(</span><em>sites</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_of_sites.html#Set_of_Sites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_of_sites.Set_of_Sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The Set_of_Sites object groups together all of the Site objects into one object and contains functions for the calculations that provide properties of all of the sites together rather than individually.</p>
<dl class="method">
<dt id="pyscses.set_of_sites.Set_of_Sites.calculate_defect_density">
<code class="descname">calculate_defect_density</code><span class="sig-paren">(</span><em>grid</em>, <em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_of_sites.html#Set_of_Sites.calculate_defect_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_of_sites.Set_of_Sites.calculate_defect_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the defect density at each site.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>object</em>) – Grid object - contains properties of the grid including the x coordinates and the volumes. Used to access the x coordinates.</li>
<li><strong>phi</strong> (<em>array</em>) – electrostatic potential on a one-dimensional grid.</li>
<li><strong>temp</strong> (<em>float</em>) – Absolute temperature.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">defect density for each site using their grid points</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">defect_density (array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.set_of_sites.Set_of_Sites.calculate_energies_on_grid">
<code class="descname">calculate_energies_on_grid</code><span class="sig-paren">(</span><em>grid</em>, <em>phi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_of_sites.html#Set_of_Sites.calculate_energies_on_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_of_sites.Set_of_Sites.calculate_energies_on_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array of energies at their points on a one-dimensional grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>object</em>) – Grid object - contains properties of the grid including the x coordinates and the volumes. Used to access the x coordinates.</li>
<li><strong>phi</strong> (<em>array</em>) – electrostatic potential on a one-dimensional grid.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">energies at their grid points</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">energies_on_grid (array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.set_of_sites.Set_of_Sites.calculate_probabilities">
<code class="descname">calculate_probabilities</code><span class="sig-paren">(</span><em>grid</em>, <em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_of_sites.html#Set_of_Sites.calculate_probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_of_sites.Set_of_Sites.calculate_probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the probability of a site being occupied by its corresponding defect.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>grid</strong> (<em>object</em>) – Grid object - contains properties of the grid including the x coordinates and the volumes. Used to access the x coordinates.</li>
<li><strong>phi</strong> (<em>array</em>) – electrostatic potential on a one-dimensional grid.</li>
<li><strong>temp</strong> (<em>float</em>) – Absolute temperature.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">probabilities of defects occupying each site using their grid points</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">probability (array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pyscses.set_of_sites.Set_of_Sites.core_width_analysis">
<em class="property">classmethod </em><code class="descname">core_width_analysis</code><span class="sig-paren">(</span><em>input_data</em>, <em>limits</em>, <em>defect_species</em>, <em>site_charge</em>, <em>core</em>, <em>temperature</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_of_sites.html#Set_of_Sites.core_width_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_of_sites.Set_of_Sites.core_width_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculated the width of the ‘core’ region. This is given as the region where the segregation energies in the system are within a region of positive to negative kT.
:param input_data: A .txt file where each line includes information about a site.
:type input_data: file
:param limits: Minimum and maximum x coordinates defining the calculation region.
:type limits: list
:param defect_species: Class object containing information about the defect species present in the system.
:type defect_species: object
:param site_charge: The site charge refers to the contribution to the overall charge of a site given by the original, non-defective species present at that site. True if the site charge contribution is to be included in the calculation, False if it is not to be included.
:type site_charge: bool
:param core: Core definition. Allowed keywords: ‘single’ = Single segregation energy used to define the core. ‘multi-site’ = Layered segregation energies used to define the core while the energies fall in the region of positive and negative kT. ‘all’ = All sites between a minimum and maximum x coordinate used in calculation.
:type core: str
:param temperature: Temperature that the calculation is being run at.
:type temperature: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Distance between the minimum and maximum x coordinates where the segregation energy is in the range of positive to negative kT.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">core_width (float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.set_of_sites.Set_of_Sites.form_continuum_sites">
<code class="descname">form_continuum_sites</code><span class="sig-paren">(</span><em>x_min</em>, <em>x_max</em>, <em>n_points</em>, <em>b</em>, <em>c</em>, <em>defect_species</em>, <em>limits_for_laplacian</em>, <em>site_labels</em>, <em>defect_labels</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_of_sites.html#Set_of_Sites.form_continuum_sites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_of_sites.Set_of_Sites.form_continuum_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Set_of_Sites object for sites interpolated onto a regular grid, this is equivalent to assuming a continuum approximation.
:param all_sites: Orginal Set_of_Sites object from full data.
:type all_sites: object
:param x_min: Minimum x coordinate value defining the calculation region.
:type x_min: float
:param x_max: Maximum x coordinate value defining the calculation region.
:type x_max: float
:param n_points: Number of points that the data should be interpolated on to.
:type n_points: int
:param b: b dimension for every grid point.
:type b: float
:param c: c dimension for every grid point.
:type c: float
:param defect_species: Class object containing information about the defect species present in the system.
:type defect_species: object
:param limits for laplacian: distance between the endmost sites and the midpoint of the next site outside of the calculation region for the first and last sites respectively.
:type limits for laplacian: list
:param site_labels: List of strings for the different site species.
:type site_labels: list
:param defect_labels: List of strings for the different defect species.
:type defect_labels: list</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Sites interpolated onto a regular grid.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyscses.set_of_sites.Set_of_Sites" title="pyscses.set_of_sites.Set_of_Sites">Set_of_Sites</a> (object)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.set_of_sites.Set_of_Sites.form_continuum_sites_new">
<code class="descname">form_continuum_sites_new</code><span class="sig-paren">(</span><em>x_min</em>, <em>x_max</em>, <em>n_points</em>, <em>b</em>, <em>c</em>, <em>defect_species</em>, <em>limits_for_laplacian</em>, <em>site_labels</em>, <em>defect_labels</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_of_sites.html#Set_of_Sites.form_continuum_sites_new"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_of_sites.Set_of_Sites.form_continuum_sites_new" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyscses.set_of_sites.Set_of_Sites.get_coords">
<code class="descname">get_coords</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_of_sites.html#Set_of_Sites.get_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_of_sites.Set_of_Sites.get_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the x coordinates for all the sites wich contain a particular defect
:param label: Label identifying the required defect species.
:type label: str</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of sites for a specific defect species.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">sites (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pyscses.set_of_sites.Set_of_Sites.set_of_sites_from_input_data">
<em class="property">classmethod </em><code class="descname">set_of_sites_from_input_data</code><span class="sig-paren">(</span><em>input_data</em>, <em>limits</em>, <em>defect_species</em>, <em>site_charge</em>, <em>core</em>, <em>temperature</em>, <em>offset=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_of_sites.html#Set_of_Sites.set_of_sites_from_input_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_of_sites.Set_of_Sites.set_of_sites_from_input_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the data from the input file and creates a Set_of_Sites object for those sites.
The input data file is a .txt file where each line in the file corresponds to a site. The values in each line are formatted and separated into the corresponding properties before creating a Site object for each site.
:param input_data: A .txt file where each line includes the information about a site.
:type input_data: file
:param limits: Minimum and maximum x coordinated defining the calculation region.
:type limits: list
:param defect_species: Class object containing information about the defect species present in the system.
:type defect_species: object
:param site_charge: The site charge refers to the contribution to the overall charge of a site given by the original, non-defective species present at that site. True if the site charge contribution is to be included in the calculation, False if it is not to be included.
:type site_charge: bool
:param core: Core definition. ‘single’ = Single segregation energy used to define the core. ‘multi-site’ = Layered segregation energies used to define the core while the energies fall in the region of positive and negative kT. ‘all’ = All sites between a minimum and maximum x coordinate used in calculation.
:type core: str
:param temperature: Temperature that the calculation is being run at.
:type temperature: float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Set of Sites object for the input data.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#pyscses.set_of_sites.Set_of_Sites" title="pyscses.set_of_sites.Set_of_Sites">Set_of_Sites</a> (object)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.set_of_sites.Set_of_Sites.subgrid_calculate_defect_density">
<code class="descname">subgrid_calculate_defect_density</code><span class="sig-paren">(</span><em>sub_grid</em>, <em>full_grid</em>, <em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_of_sites.html#Set_of_Sites.subgrid_calculate_defect_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_of_sites.Set_of_Sites.subgrid_calculate_defect_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the defect density at each site for a given subset of sites.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>subgrid</strong> (<em>object</em>) – Grid object - contains properties of the grid including the x coordinates and the volumes. Used to access the x coordinates. For a given subset of sites.</li>
<li><strong>full_grid</strong> (<em>object</em>) – Grid object - contains properties of the grid including the x coordinates and the volumes. Used to access the x coordinates. For all sites.</li>
<li><strong>phi</strong> (<em>array</em>) – electrostatic potential on a one-dimensional grid.</li>
<li><strong>temp</strong> (<em>float</em>) – Absolute temperature.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">defect density for each site using their grid points</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">defect_density (array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.set_of_sites.Set_of_Sites.subset">
<code class="descname">subset</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_of_sites.html#Set_of_Sites.subset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_of_sites.Set_of_Sites.subset" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all the sites which contain a particular defect</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyscses.set_up_calculation">
<span id="pyscses-set-up-calculation-module"></span><h2>pyscses.set_up_calculation module<a class="headerlink" href="#module-pyscses.set_up_calculation" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyscses.set_up_calculation.average_similar_sites">
<code class="descclassname">pyscses.set_up_calculation.</code><code class="descname">average_similar_sites</code><span class="sig-paren">(</span><em>input_data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_up_calculation.html#average_similar_sites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_up_calculation.average_similar_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Corrects for rounding errors in the input data. Sites within 0.02nm are taken as the same site, therefore the x coordinate values are averaged to prevent the formation of separate sites.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>input_data</strong> (<em>str</em>) – The input file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The input file, formatted with x coordinate values within 0.02nm averaged and set to the same value.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">input_data (str)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyscses.set_up_calculation.calculate_grid_offsets">
<code class="descclassname">pyscses.set_up_calculation.</code><code class="descname">calculate_grid_offsets</code><span class="sig-paren">(</span><em>filename</em>, <em>x_min</em>, <em>x_max</em>, <em>system</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_up_calculation.html#calculate_grid_offsets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_up_calculation.calculate_grid_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in the input data calculates the distance to the next site outside of the defined calculation region. Allows calculation of the delta_x and volume values for the endmost grid points.
:param filename: Filename for importing the input data.
:type filename: string
:param x_min: Minimum x coordinate value defining the calculation region.
:type x_min: float
:param x_max: Maximum x coordinate value defining the calculation region.
:type x_max: float
:param system: ‘single’ for single grain boundary systems, ‘double’ for systems where the input data has been mirrored to give two grain boundaries.
:type system: str</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">distance between the midpoint of the endmost sites and the midpoint of the next site outside of the calculation region for the first and last sites respectively.
limits_for_laplacian(list): distance between the endmost sites and the next site outside of the calculation region for the first and last sites respectively.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">limits(list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyscses.set_up_calculation.format_line">
<code class="descclassname">pyscses.set_up_calculation.</code><code class="descname">format_line</code><span class="sig-paren">(</span><em>line</em>, <em>site_charge</em>, <em>offset=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_up_calculation.html#format_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_up_calculation.format_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Each line in the input file is formatted into separate site properties.
:param line: A line in the input file.
:type line: str
:param site_charge: The site charge refers to the contribution to the overall charge of a site given by the original, non-defective species present at that site. True if the site charge contribution is to be included in the calculation, False if it is not to be included.
:type site_charge: bool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">line from the input file, split into individual values.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">line (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyscses.set_up_calculation.load_site_data">
<code class="descclassname">pyscses.set_up_calculation.</code><code class="descname">load_site_data</code><span class="sig-paren">(</span><em>filename</em>, <em>x_min</em>, <em>x_max</em>, <em>site_charge</em>, <em>offset=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_up_calculation.html#load_site_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_up_calculation.load_site_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in the input data and formats the input data if the x coordinate values are within the calculation region.
:param filename: Filename for importing the input data.
:type filename: string
:param x_min: Minimum x coordinate value defining the calculation region.
:type x_min: float
:param x_max: Maximum x coordinate value defining the calculation region.
:type x_max: float
:param site_charge: True if site charges are to be included in the calculation, false if they are not to be included.
:type site_charge: bool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">formatted data for calculation.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">input_data(list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyscses.set_up_calculation.site_from_input_file">
<code class="descclassname">pyscses.set_up_calculation.</code><code class="descname">site_from_input_file</code><span class="sig-paren">(</span><em>site</em>, <em>defect_species</em>, <em>site_charge</em>, <em>core</em>, <em>temperature</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/set_up_calculation.html#site_from_input_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.set_up_calculation.site_from_input_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the data from the input file and converts it into a site.
The input data file is a .txt file where each line in the file corresponds to a site. The values in each line are formatted and separated into the corresponding properties before creating a Site object for each site.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>site</strong> (<em>str</em>) – A line in the input file.</li>
<li><strong>defect_species</strong> (<em>object</em>) – Class object containing information about the defect species present in the system.</li>
<li><strong>site_charge</strong> (<em>bool</em>) – The site charge refers to the contribution to the overall charge of a site given by the original, non-defective species present at that site. True if the site charge contribution is to be included in the calculation, False if it is not to be included.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Site (object)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pyscses.site">
<span id="pyscses-site-module"></span><h2>pyscses.site module<a class="headerlink" href="#module-pyscses.site" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyscses.site.Site">
<em class="property">class </em><code class="descclassname">pyscses.site.</code><code class="descname">Site</code><span class="sig-paren">(</span><em>label</em>, <em>x</em>, <em>defect_species</em>, <em>defect_energies</em>, <em>scaling=None</em>, <em>valence=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/site.html#Site"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.site.Site" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="docutils">
<dt>The site class contains all the information about a given site and the defect occupying that site.</dt>
<dd>This class contains functions for the calculations which correspond to each individual site, rather than the system as a whole.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>label</strong> (<em>str</em>) – refers to what the defect is called i.e. ‘Vo’ for an oxygen vacancy.</li>
<li><strong>x</strong> (<em>float</em>) – x coordinate of the site.</li>
<li><strong>defect_energies</strong> (<em>list</em>) – List of segregation energies for all defects present at the site.</li>
<li><strong>defect_species</strong> (<em>list</em>) – List of defect species for all defects present at the site.</li>
<li><strong>defects</strong> (<em>list</em>) – List of Defect_at_Site objects, containing the properties of all individual defects at the site.</li>
<li><strong>scaling</strong> (<em>float</em>) – A scaling factor that can be applied in the charge calculation.</li>
<li><strong>valence</strong> (<em>float</em>) – The charge of the defect present at the site (in atomic units).</li>
<li><strong>defects</strong> – List of Defect_Species objects for all defects present at the site.</li>
<li><strong>sites</strong> (<em>list</em>) – List containing all x coordinates and corresponding  defect segregation energies.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pyscses.site.Site.average_local_energy">
<code class="descname">average_local_energy</code><span class="sig-paren">(</span><em>method='mean'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/site.html#Site.average_local_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.site.Site.average_local_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average local segregation energy for each site based on a specified method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>method</strong> (<em>str</em>) – The method in which the average segregation energies will be calculated.
‘mean’ - Returns the sum of all values at that site divided by the number of values at that site.
‘min’ - Returns the minimum segregation energy value for that site (appropriate for low temperature calculations).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Average segregation energies on the site coordinates grid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">average site energies (np.array)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.site.Site.charge">
<code class="descname">charge</code><span class="sig-paren">(</span><em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/site.html#Site.charge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.site.Site.charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the overall charge in Coulombs at each site.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>float</em>) – Electrostatic potential at this site.</li>
<li><strong>temp</strong> (<em>float</em>) – Temperature of calculation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The charge on a 1D grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">charge (np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.site.Site.charge_boltz">
<code class="descname">charge_boltz</code><span class="sig-paren">(</span><em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/site.html#Site.charge_boltz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.site.Site.charge_boltz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the charge in Coulombs at each site using Boltzmann probabilities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>float</em>) – Electrostatic potential at this site</li>
<li><strong>temp</strong> (<em>float</em>) – Temperature of calculation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The charge on a 1D grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">charge (np.array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.site.Site.defect_valences">
<code class="descname">defect_valences</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/site.html#Site.defect_valences"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.site.Site.defect_valences" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array of valences for each defect from self.defects</p>
</dd></dl>

<dl class="method">
<dt id="pyscses.site.Site.defect_with_label">
<code class="descname">defect_with_label</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/site.html#Site.defect_with_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.site.Site.defect_with_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of defects which correspond to the given label</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>label</strong> (<em>str</em>) – Label to identify defect species.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of Defect_at_Site objects for a specific defect species.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.site.Site.energies">
<code class="descname">energies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/site.html#Site.energies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.site.Site.energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the segregation energies for each defect from self.defects</p>
</dd></dl>

<dl class="method">
<dt id="pyscses.site.Site.probabilities">
<code class="descname">probabilities</code><span class="sig-paren">(</span><em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/site.html#Site.probabilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.site.Site.probabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the probability of each site being occupied. Derived from the chemical potential term for a Fermi-Dirac like distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>float</em>) – Electrostatic potential at this site.</li>
<li><strong>temp</strong> (<em>float</em>) – Temperature of calculation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Probabilities of site occupation on a 1D grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">probabilities (list)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.site.Site.probabilities_boltz">
<code class="descname">probabilities_boltz</code><span class="sig-paren">(</span><em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/site.html#Site.probabilities_boltz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.site.Site.probabilities_boltz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the probability of each site being occupied by a given defect. Derived from the chemical potential including a Boltzmann distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>float</em>) – Electrostatic potential at this site.</li>
<li><strong>temp</strong> (<em>float</em>) – Temperature of calculation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Probabilities of site occupation on a 1D grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">boltzmann_probabilities (list)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyscses.site.Site.sum_of_boltzmann_three">
<code class="descname">sum_of_boltzmann_three</code><span class="sig-paren">(</span><em>phi</em>, <em>temp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscses/site.html#Site.sum_of_boltzmann_three"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscses.site.Site.sum_of_boltzmann_three" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the sum of the calculated boltzmann_three values for each defect at each site.  i</p>
<div class="math notranslate nohighlight">
\[\sum(x_i\exp(-\Phi_xz/kT)-1)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>float</em>) – Electrostatic potential at the site.</li>
<li><strong>temp</strong> (<em>float</em>) – Temperature of calculation in Kelvin.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The sum of Boltzmann terms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyscses">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyscses" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="modules.html" class="btn btn-neutral" title="pyscses" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Georgina Wellock

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>